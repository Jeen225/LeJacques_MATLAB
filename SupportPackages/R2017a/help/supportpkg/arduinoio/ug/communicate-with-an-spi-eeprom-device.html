<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml" itemscope itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Communicate with a SPI EEPROM Device</title>
<link rel="stylesheet" href="docstyle.css" type="text/css"><link href="../includes/product/css/bootstrap.min.css" rel="stylesheet" type="text/css">


  <meta http-equiv="Content-Script-Type" content="text/javascript">
<meta name="toctype" itemprop="pagetype" content="ug">
<meta name="infotype" itemprop="infotype" content="ex" />

<meta name="description" itemprop="description" content="Learn how to store and retrieve data from an SPI EEPROM device." />
<script type="text/javascript" src="../includes/product/scripts/jquery/jquery-latest.js"></script>
<link href="../includes/product/css/site6.css?201706221413" rel="stylesheet" type="text/css">
<link href="../includes/product/css/site6_lg.css?201706221413" rel="stylesheet" media="screen and (min-width: 1200px)">
<link href="../includes/product/css/site6_md.css?201706221413" rel="stylesheet" media="screen and (min-width: 992px) and (max-width: 1199px)">
<link href="../includes/product/css/site6_sm+xs.css?201706221413" rel="stylesheet" media="screen and (max-width: 991px)">
<link href="../includes/product/css/site6_sm.css?201706221413" rel="stylesheet" media="screen and (min-width: 768px) and (max-width: 991px)">
<link href="../includes/product/css/site6_xs.css?201706221413" rel="stylesheet" media="screen and (max-width: 767px)">
<link href="../includes/product/css/site6_offcanvas.css?201706221413" rel="stylesheet" type="text/css">

<script src="../includes/shared/scripts/l10n.js"></script>
<script src="../includes/shared/scripts/docscripts.js"></script>
<script src="../includes/shared/scripts/f1help.js"></script>
<script src="../includes/product/scripts/docscripts.js"></script>
<script src="../includes/shared/scripts/mw.imageanimation.js"></script>
<script src="../includes/shared/scripts/jquery.highlight.js"></script>
<script src="../includes/product/scripts/underscore-min.js"></script>
<script src="../includes/product/scripts/examples.js"></script>
<script src="../includes/product/scripts/use_platform_screenshots.js"></script>
<script src="../includes/product/scripts/suggest.js"></script>
<script src="../includes/shared/scripts/overload.js"></script>





<script src="../includes/product/scripts/jquery/jquery.mobile.custom.min.js"></script>
<script src="../includes/product/scripts/bootstrap.min.js" type="text/javascript"></script>
<script src="../includes/product/scripts/global.js"></script>
<link href="../includes/product/css/doc_center.css" rel="stylesheet" type="text/css">
<link href="../includes/product/css/doc_center_installed.css" rel="stylesheet" type="text/css">
<link href="../includes/product/css/doc_center_print.css" rel="stylesheet" type="text/css" media="print">
<script type="text/javascript" src="../includes/shared/equationrenderer/release/MathRenderer.js"></script>
</head>
<body id="responsive_offcanvas">
<div id="doc_header_spacer" class="header"></div>
<div class="sticky_header_container includes_subnav">
<div class="section_header level_3">
<div class="container-fluid">
<div class="row" id="mobile_search_row">
<div class="col-xs-12 col-sm-6 col-sm-push-6 col-md-5 col-md-push-7" id="mobile_search">
<div class="search_nested_content_container">
<form id="docsearch_form" name="docsearch_form" method="get" data-release="R2017a" data-language="en" action="../../../templates/searchresults.html">
<div class="input-group tokenized_search_field">
<label class="sr-only">Search Help</label>
<input type="text" class="form-control conjoined_search" autocomplete="off" name="qdoc" placeholder="Search Help" id="docsearch">
<div class="input-group-btn">
<button type="submit" name="submitsearch" id="submitsearch" class="btn icon-search btn_search_adjacent btn_search icon_16" tabindex="-1"></button>
</div>
</div>
</form>
</div>
<button class="btn icon-remove btn_search pull-right icon_32 visible-xs" data-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div>
<div class="col-sm-6 col-sm-pull-6 col-md-7 col-md-pull-5" id="section_header_title">
<div class="section_header_content">
<div class="section_header_title">
<h1><a href="../../../documentation-center.html">Documentation</a></h1>
</div>
</div>
</div>
<div class="visible-xs" id="search_actuator">
<button class="btn icon-search btn_search pull-right icon_16" data-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button>
</div>
</div><!--END.CLASS row-->
</div><!--END.CLASS container-fluid-->
</div><!--END.CLASS section_header level_3-->
<div class="horizontal_nav">
<div class="horizontal_nav_container">
<div class="offcanvas_actuator" data-toggle="offcanvas" data-target="#sidebar" id="nav_toggle">
<button type="button" class="btn"><span class="sr-only">Toggle navigation</span><span class="icon-menu icon_24"></span></button>
<span class="offcanvas_actuator_label"></span><span class="offcanvas_actuator_close"></span>
</div>
<div class="offcanvas_horizontal_nav">
<div class="container-fluid">
<div class="row">
<div class="col-md-12 hidden-xs hidden-sm"></div>
</div>
</div>
</div>
</div>
</div>
</div><!--END.CLASS sticky_header_container-->
<div class="row-offcanvas row-offcanvas-left">
<div class="sidebar-offcanvas" id="sidebar" role="navigation">
<nav class="offcanvas_nav" role="navigation">
<ul xmlns:atict="http://www.arbortext.com/namespace/atict" class="nav_breadcrumb">
<li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../../../documentation-center.html" itemprop="url"><span itemprop="title">Documentation Home</span></a></li>
</ul>

<ul xmlns:atict="http://www.arbortext.com/namespace/atict" class="nav_disambiguation">
<li class="product"><a href="../index.html">MATLAB Support Package for Arduino Hardware</a>
<div class="dropdown">
<span class="icon-arrow-down icon_16" id="dropdownMenu1" data-toggle="dropdown"></span>
<ul class="dropdown-menu dropdown-menu-right" role="menu" aria-labelledby="dropdownMenu1">
<li role="presentation"><a role="menuitem" tabindex="-1" href="../examples.html?s_cid=doc_flyout">Examples</a></li>
<li role="presentation"><a role="menuitem" tabindex="-1" href="../troubleshooting-in-matlab-support-package-for-arduino-hardware.html?s_cid=doc_flyout">Troubleshooting</a></li>
<li role="presentation"><a role="menuitem" tabindex="-1" href="../functionlist.html?s_cid=doc_flyout">Functions and Other Reference</a></li>
<li role="presentation"><a role="menuitem" tabindex="-1" href="../release-notes.html?s_cid=doc_flyout">Release Notes</a></li>
</ul>
</div>
</li>
<li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../spi-sensors.html" itemprop="url"><span itemprop="title">SPI Devices</span></a></li>
</ul>
<ul xmlns:atict="http://www.arbortext.com/namespace/atict" class="nav_scrollspy nav">
<li class="nav_scrollspy_function"><a href="#responsive_offcanvas">Communicate with a SPI EEPROM Device</a></li>
<li class="nav_scrollspy_title">On this page</li>
</ul>
</nav>
<script src="../includes/product/scripts/offcanvas.js"></script></div><!--END.CLASS sidebar-offcanvas-->
<div class="content_container" id="content_container">
<div class="container-fluid">
<div class="row">
<div class="col-xs-12">

<section id="doc_center_content" lang="en"><div id="pgtype-topic">
<span id="bumvmvb-1" class="anchor_target"></span><h2 class="title r2017a" itemprop="title content" id="bumvmvb-1">Communicate with a SPI EEPROM Device</h2><div itemprop="content">
<p>This example shows how to store and retrieve
data from an EEPROM on a SPI device. Using EEPROM you can read, erase,
and rewrite individual bits of data from the sensor's memory.
This example uses SPI EEPROM 25AA080C device from Microchip Technology
with the Arduino<sup>&#x00AE;</sup> Mega 2560. Before using this example, wire an
EEPROM to the SPI pins on your Arduino as described:</p>
<div class="table-responsive"><table class="table table-condensed" border="2"><colgroup><col width="50%"><col width="50%"></colgroup><thead><tr valign="top"><th valign="top">SPI EEPROM Pins</th><th valign="top">Arduino Pins</th></tr>
</thead><tbody><tr valign="top"><td>/CS</td><td>Digital pin 10</td></tr>
<tr valign="top"><td>SO</td><td>ICSP-1 (MISO) </td></tr>
<tr valign="top"><td>/WP</td><td>50k or 100k ohm resistor tied to Vcc </td></tr>
<tr valign="top"><td>VSS</td><td>Arduino Gnd</td></tr>
<tr valign="top"><td>SI</td><td>ICSP-4 (MOSI)</td></tr>
<tr valign="top"><td>SCK</td><td>ICSP-3 (SCK)</td></tr>
<tr valign="top"><td>/HOLD</td><td>Vcc</td></tr>
<tr valign="top"><td>Vcc</td><td>5v pin</td></tr>
</tbody></table></div><p></p><p>It is also recommended that
you place a 1uF decoupling capacitor between VCC and Gnd.</p>
</div><div class="clearfix"></div><div itemprop="content"><p>Create a SPI connection on your Arduino.</p><p>Create an Arduino object and include the SPI library.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>a = arduino(<span style="color:#A020F0">'COM5'</span>, <span style="color:#A020F0">'Mega2560'</span>, <span style="color:#A020F0">'Libraries'</span>, <span style="color:#A020F0">'I2C, SPI, Servo'</span>);
</pre></div></div></div><p>Write to, and read back data from an EEPROM, which is
a micro controller designed to interface directly with the Serial
Peripheral Interface (SPI). For more information about the read and
write sequence in an EEPROM, refer to the functional description in
the <a href="http://ww1.microchip.com/downloads/en/DeviceDoc/22151A.pdf" target="_top">EEPROM
Data Sheet</a>.</p><p>Create a chip select pin connection.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>Cspin = <span style="color:#A020F0">'d10'</span>;</pre></div></div></div><p>Create a SPI device object.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>eeprom = spidev(a, Cspin, <span style="color:#A020F0">'bitorder'</span>, <span style="color:#A020F0">'msbfirst'</span>, <span style="color:#A020F0">'mode'</span>, 0)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>eeprom = 

  spidev with properties:

    ChipSelectPin: D10             
             Pins: D51(MOSI), D50(MISO), D52(SCK), D53(SS)
             Mode: 0               (0, 1, 2 or 3)
         BitOrder: msbfirst        ('msbfirst' or 'lsbfirst')
          BitRate: 4000000</pre></div></div></div><p>Specify the read, write and write enable commands referring
to the EEPROM instruction set .</p><div class="table-responsive"><table class="table table-condensed" border="2"><colgroup><col width="18%"><col width="23%"><col width="59%"></colgroup><thead><tr valign="top"><th valign="top">Instruction Name</th><th valign="top">Instruction Format</th><th valign="top">Description</th></tr>
</thead><tbody><tr valign="top"><td><p><code>read</code></p></td><td><p>0000 0011</p></td><td><p>Read data from memory array beginning at selected address</p></td></tr>
<tr valign="top"><td><p><code>write</code> </p></td><td><p>0000 0010 </p></td><td><p>Write data to memory array beginning at selected address</p></td></tr>
<tr valign="top"><td><p><code>wrdi</code></p></td><td><p>0000 0100</p></td><td><p>Reset the write enable latch (disable write operations)</p></td></tr>
<tr valign="top"><td><p><code>wren</code></p></td><td><p>0000 0110</p></td><td><p>Set the write enable latch (enable write operations)</p></td></tr>
<tr valign="top"><td><p><code>rdsr</code></p></td><td><p>0000 0101 </p></td><td><p>Read STATUS Register</p></td></tr>
<tr valign="top"><td><p><code>wrsr</code></p></td><td><p>0000 0001 </p></td><td><p>Write STATUS Register</p></td></tr>
</tbody></table></div><p></p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>readCmd = bin2dec(<span style="color:#A020F0">'0000 0011'</span>);
writeCmd = bin2dec(<span style="color:#A020F0">'0000 0010'</span>);
writeEnable = bin2dec(<span style="color:#A020F0">'0000 0110'</span>);</pre></div></div></div><p>Write enable the device.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>writeRead(eeprom, writeEnable);
</pre></div></div></div><p>Set the device address. The address is a 16&#8211;bit
value, with 8 upper and 8 lower bits. The highest value on the address
can be 0x03FF.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>address = [0 0];</pre></div></div></div><p>Write 'Hello' at the 0th address of EEPROM.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>dataToWrite = [writeCmd,address double(<span style="color:#A020F0">'Hello'</span>)];
writeRead(eeprom, dataToWrite)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>ans =

     0     0     0     0     0     0     0     0</pre></div></div></div><p>Read back the data from the EEPROM.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>dataToWrite2 = [readCmd address zeros(1,5)];
returnedData = writeRead(eeprom, dataToWrite2)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>returnedData =

     0     0     0    72   101   108   108   111</pre></div></div></div><p>Display the result.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>disp(char(returnedData(4:end)));
</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>Hello</pre></div></div></div></div>
</div></section>

<div class="clearfix"></div>
<div class="feedbackblock">Was this topic helpful?
<input type="button" value="Yes" onClick="openFeedbackWindow('http://www.mathworks.com/programs/bounce_hub_help.html?s_cid=Help_Topic_Survey&amp;surveyParams='+document.location.href+'-YES-R2017a');">
<input type="button" value="No" onClick="openFeedbackWindow('http://www.mathworks.com/programs/bounce_hub_help.html?s_cid=Help_Topic_Survey&amp;surveyParams='+document.location.href+'-NO-R2017a');">
</div>
<!--Last updated: Thu Jun 22 14:13:07 EDT 2017-->
</div>
</div>
</div><!--close_0960-->
</div><!--close_0970-->
<div class="body_trail_container">
<div class="container-fluid">
<div class="row">
<div class="col-xs-12">
<div class="row"><div class="col-xs-12 col-sm-3"><h5><a href="../index.html?s_cid=doc_ftr">MATLAB Support Package for Arduino Hardware Documentation</a></h5>
<ul class="list-unstyled hidden-xs"><li><a href="../examples.html?s_cid=doc_ftr">Examples</a></li>
<li><a href="../troubleshooting-in-matlab-support-package-for-arduino-hardware.html?s_cid=doc_ftr">Troubleshooting</a></li>
<li><a href="../functionlist.html?s_cid=doc_ftr">Functions and Other Reference</a></li>
<li><a href="../release-notes.html?s_cid=doc_ftr">Release Notes</a></li>
</ul>
</div>
<div class="col-xs-12 col-sm-3"><h5><a href="../../../documentation-center.html?s_cid=doc_ftr">Other Documentation</a></h5>
<ul class="list-unstyled hidden-xs"><li><a href="../../../matlab/index.html?s_cid=doc_ftr">MATLAB</a></li><li><a href="../../../supportpkg/arduino/index.html?s_cid=doc_ftr">Simulink Support Package for Arduino Hardware</a></li><li><a href="../../../supportpkg/raspberrypiio/index.html?s_cid=doc_ftr">MATLAB Support Package for Raspberry Pi Hardware</a></li><li><a href="../../../supportpkg/legomindstormsev3io/index.html?s_cid=doc_ftr">MATLAB Support Package for LEGO MINDSTORMS EV3 Hardware</a></li><li><a href="../../../documentation-center.html?s_cid=doc_ftr">Documentation Home</a></li></ul>
</div>
<div class="col-xs-12 col-sm-3"><h5><a href="http://www.mathworks.com/support/?s_cid=doc_ftr">Support</a></h5>
<ul class="list-unstyled hidden-xs"><li><a href="http://www.mathworks.com/matlabcentral/answers/index?s_cid=doc_ftr">MATLAB Answers</a></li><li><a href="http://www.mathworks.com/support/install-matlab.html?s_cid=doc_ftr">Installation Help</a></li><li><a href="http://www.mathworks.com/support/bugreports/?s_cid=doc_ftr">Bug Reports</a></li><li><a href="http://www.mathworks.com/products/availability/?s_cid=doc_ftr">Product Requirements</a></li><li><a href="http://www.mathworks.com/downloads/?s_cid=doc_ftr">Software Downloads</a></li></ul>
</div>
</div>
</div>
</div>
</div><!--END.CLASS container-fluid-->
</div><!--END.CLASS body_trail_container-->
<footer id="footer" class="bs-footer">
<div class="container-fluid">
<div class="footer">
<div class="row">
<div class="col-xs-12">
<p class="copyright">&copy; 1994-2017 The MathWorks, Inc.</p>
<ul class="footernav"><li class="footernav_help"><a href="MATLAB:web(matlab.internal.licenseAgreement)">Terms of Use</a></li><li class="footernav_patents"><a href="MATLAB:web([matlabroot '/patents.txt'])">Patents</a></li><li class="footernav_trademarks"><a href="MATLAB:web([matlabroot '/trademarks.txt'])">Trademarks</a></li><li class="footernav_piracy"><a href="MATLAB:web([docroot '/acknowledgments.html'])">Acknowledgments</a></li></ul></div>
</div>
</div>
</div>
</footer>
</div><!--close row-offcanvas-->
</body>
</html>
