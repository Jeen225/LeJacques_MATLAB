<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml" itemscope itemtype="http://www.mathworks.com/help/schema/MathWorksDocPage">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Create HelloWorld Add-On</title>
<link rel="stylesheet" href="docstyle.css" type="text/css"><link href="../includes/product/css/bootstrap.min.css" rel="stylesheet" type="text/css">


  <meta http-equiv="Content-Script-Type" content="text/javascript">
<meta name="toctype" itemprop="pagetype" content="ug">
<meta name="infotype" itemprop="infotype" content="ex" />

<meta name="description" itemprop="description" content="Create your first MATLAB Arduino add-on library." />
<script type="text/javascript" src="../includes/product/scripts/jquery/jquery-latest.js"></script>
<link href="../includes/product/css/site6.css?201706221413" rel="stylesheet" type="text/css">
<link href="../includes/product/css/site6_lg.css?201706221413" rel="stylesheet" media="screen and (min-width: 1200px)">
<link href="../includes/product/css/site6_md.css?201706221413" rel="stylesheet" media="screen and (min-width: 992px) and (max-width: 1199px)">
<link href="../includes/product/css/site6_sm+xs.css?201706221413" rel="stylesheet" media="screen and (max-width: 991px)">
<link href="../includes/product/css/site6_sm.css?201706221413" rel="stylesheet" media="screen and (min-width: 768px) and (max-width: 991px)">
<link href="../includes/product/css/site6_xs.css?201706221413" rel="stylesheet" media="screen and (max-width: 767px)">
<link href="../includes/product/css/site6_offcanvas.css?201706221413" rel="stylesheet" type="text/css">

<script src="../includes/shared/scripts/l10n.js"></script>
<script src="../includes/shared/scripts/docscripts.js"></script>
<script src="../includes/shared/scripts/f1help.js"></script>
<script src="../includes/product/scripts/docscripts.js"></script>
<script src="../includes/shared/scripts/mw.imageanimation.js"></script>
<script src="../includes/shared/scripts/jquery.highlight.js"></script>
<script src="../includes/product/scripts/underscore-min.js"></script>
<script src="../includes/product/scripts/examples.js"></script>
<script src="../includes/product/scripts/use_platform_screenshots.js"></script>
<script src="../includes/product/scripts/suggest.js"></script>
<script src="../includes/shared/scripts/overload.js"></script>





<script src="../includes/product/scripts/jquery/jquery.mobile.custom.min.js"></script>
<script src="../includes/product/scripts/bootstrap.min.js" type="text/javascript"></script>
<script src="../includes/product/scripts/global.js"></script>
<link href="../includes/product/css/doc_center.css" rel="stylesheet" type="text/css">
<link href="../includes/product/css/doc_center_installed.css" rel="stylesheet" type="text/css">
<link href="../includes/product/css/doc_center_print.css" rel="stylesheet" type="text/css" media="print">
<script type="text/javascript" src="../includes/shared/equationrenderer/release/MathRenderer.js"></script>
</head>
<body id="responsive_offcanvas">
<div id="doc_header_spacer" class="header"></div>
<div class="sticky_header_container includes_subnav">
<div class="section_header level_3">
<div class="container-fluid">
<div class="row" id="mobile_search_row">
<div class="col-xs-12 col-sm-6 col-sm-push-6 col-md-5 col-md-push-7" id="mobile_search">
<div class="search_nested_content_container">
<form id="docsearch_form" name="docsearch_form" method="get" data-release="R2017a" data-language="en" action="../../../templates/searchresults.html">
<div class="input-group tokenized_search_field">
<label class="sr-only">Search Help</label>
<input type="text" class="form-control conjoined_search" autocomplete="off" name="qdoc" placeholder="Search Help" id="docsearch">
<div class="input-group-btn">
<button type="submit" name="submitsearch" id="submitsearch" class="btn icon-search btn_search_adjacent btn_search icon_16" tabindex="-1"></button>
</div>
</div>
</form>
</div>
<button class="btn icon-remove btn_search pull-right icon_32 visible-xs" data-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button></div>
<div class="col-sm-6 col-sm-pull-6 col-md-7 col-md-pull-5" id="section_header_title">
<div class="section_header_content">
<div class="section_header_title">
<h1><a href="../../../documentation-center.html">Documentation</a></h1>
</div>
</div>
</div>
<div class="visible-xs" id="search_actuator">
<button class="btn icon-search btn_search pull-right icon_16" data-toggle="collapse" href="#mobile_search" aria-expanded="false" aria-controls="mobile_search"></button>
</div>
</div><!--END.CLASS row-->
</div><!--END.CLASS container-fluid-->
</div><!--END.CLASS section_header level_3-->
<div class="horizontal_nav">
<div class="horizontal_nav_container">
<div class="offcanvas_actuator" data-toggle="offcanvas" data-target="#sidebar" id="nav_toggle">
<button type="button" class="btn"><span class="sr-only">Toggle navigation</span><span class="icon-menu icon_24"></span></button>
<span class="offcanvas_actuator_label"></span><span class="offcanvas_actuator_close"></span>
</div>
<div class="offcanvas_horizontal_nav">
<div class="container-fluid">
<div class="row">
<div class="col-md-12 hidden-xs hidden-sm"></div>
</div>
</div>
</div>
</div>
</div>
</div><!--END.CLASS sticky_header_container-->
<div class="row-offcanvas row-offcanvas-left">
<div class="sidebar-offcanvas" id="sidebar" role="navigation">
<nav class="offcanvas_nav" role="navigation">
<ul xmlns:atict="http://www.arbortext.com/namespace/atict" class="nav_breadcrumb">
<li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../../../documentation-center.html" itemprop="url"><span itemprop="title">Documentation Home</span></a></li>
</ul>

<ul xmlns:atict="http://www.arbortext.com/namespace/atict" class="nav_disambiguation">
<li class="product"><a href="../index.html">MATLAB Support Package for Arduino Hardware</a>
<div class="dropdown">
<span class="icon-arrow-down icon_16" id="dropdownMenu1" data-toggle="dropdown"></span>
<ul class="dropdown-menu dropdown-menu-right" role="menu" aria-labelledby="dropdownMenu1">
<li role="presentation"><a role="menuitem" tabindex="-1" href="../examples.html?s_cid=doc_flyout">Examples</a></li>
<li role="presentation"><a role="menuitem" tabindex="-1" href="../troubleshooting-in-matlab-support-package-for-arduino-hardware.html?s_cid=doc_flyout">Troubleshooting</a></li>
<li role="presentation"><a role="menuitem" tabindex="-1" href="../functionlist.html?s_cid=doc_flyout">Functions and Other Reference</a></li>
<li role="presentation"><a role="menuitem" tabindex="-1" href="../release-notes.html?s_cid=doc_flyout">Release Notes</a></li>
</ul>
</div>
</li>
<li itemscope="" itemtype="http://www.data-vocabulary.org/Breadcrumb" itemprop="breadcrumb"><a href="../custom-arduino-libraries.html" itemprop="url"><span itemprop="title">Custom Arduino Libraries</span></a></li>
</ul>
<ul xmlns:atict="http://www.arbortext.com/namespace/atict" class="nav_scrollspy nav">
<li class="nav_scrollspy_function"><a href="#responsive_offcanvas">Create HelloWorld Add-On</a></li>
<li class="nav_scrollspy_title">On this page</li>

<li><a href="#butiw8l" class="intrnllnk">Create Folder Structure</a></li>
<li><a href="#butiw_j-1" class="intrnllnk">Create C++ Code</a></li>
<li><a href="#butixcv-1" class="intrnllnk">Create MATLAB Wrapper</a></li>
<li><a href="#bu3l8rg-1" class="intrnllnk">Register Add-On</a></li>
<li><a href="#bu0d8wp-1" class="intrnllnk">Run MATLAB Code</a></li>


</ul>
</nav>
<script src="../includes/product/scripts/offcanvas.js"></script></div><!--END.CLASS sidebar-offcanvas-->
<div class="content_container" id="content_container">
<div class="container-fluid">
<div class="row">
<div class="col-xs-12">

<section id="doc_center_content" lang="en"><div id="pgtype-topic">
<span id="bus7spd-1" class="anchor_target"></span><h2 class="title r2017a" itemprop="title content" id="bus7spd-1">Create HelloWorld Add-On</h2><div itemprop="content">
<p>This example shows how to send a string from
an Arduino<sup>&#x00AE;</sup> Uno board to the MATLAB<sup>&#x00AE;</sup> command line and create
all the necessary files in your custom library using MATLAB and
C++. Files for this example are located in your Arduino support
package installation folder in <code>\arduinoio\arduinoioexamples</code>.</p>
</div><ul><li><p><a class="intrnllnk" href="#butiw8l">Create Folder Structure</a></p></li><li><p><a class="intrnllnk" href="#butiw_j-1">Create C++ Code</a></p></li><li><p><a class="intrnllnk" href="#butixcv-1">Create MATLAB Wrapper</a></p></li><li><p><a class="intrnllnk" href="#bu3l8rg-1">Register Add-On</a></p></li><li><p><a class="intrnllnk" href="#bu0d8wp-1">Run MATLAB Code</a></p></li></ul><div class="clearfix"></div><div itemprop="content"><span id="butiw8l" class="anchor_target"></span><h3 class="title" id="butiw8l">Create Folder Structure</h3><p>Create a folder package to contain all the files for your custom
library, and add it to the MATLAB path.
For this example:</p><ol type="1"><li><p>Add a folder named <code>+arduinoioaddons</code> in
your working folder. </p></li><li><p>In <code>+arduinoioaddons</code>, add a <code>+ExampleAddon</code> subfolder
to contain your MATLAB class
file. For example <code>C:\Work</code>.</p></li><li><p>In the <code>+ExampleAddon</code> subfolder,
add a <code>src</code> folder to contain your <code>C++</code> header
files.</p></li></ol><p>
<img src="filestructure.png" height="172" width="281" alt=""></p></div><div class="clearfix"></div><div itemprop="content"><span id="butiw_j-1" class="anchor_target"></span><h3 class="title" id="butiw_j-1">Create C++ Code</h3><span id="cppwrapper" class="anchor_target"></span><p>For this example, create a C++ header file named <code>HelloWorld.h</code>,
and save it in the <code>+arduinoioaddons/+ExampleAddon/src</code>folder.
This file wraps methods to expose to the Arduino library.</p><ol type="1"><li><p>Include header files, including <code>LibraryBase.h</code> and
any other third-party header file that the add-on library depends
on.</p><div class="code_responsive"><pre class="programlisting">#include "LibraryBase.h"
</pre></div></li><li><p>Create an add-on class that inherits from the <code>LibraryBase</code> class,
which defines all the necessary interfaces.</p></li><li><p>In the constructor, define the library name, and register
the library to the server.</p><div class="code_responsive"><pre class="programlisting">class HelloWorld : public LibraryBase
{
    public:
        HelloWorld(MWArduinoClass&amp; a)
        {
            libName = "ExampleAddon/HelloWorld";
            a.registerLibrary(this);
        }
</pre></div><p>The custom class and library names must have this format:</p><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>shield(vendor)/device(library)</pre></div></div></div></li><li><p>Determine the command calls to issue from MATLAB.</p></li><li><p>Override the command handler, and create a switch
case for each command that the add-on executes on the Arduino device: </p><div class="code_responsive"><pre class="programlisting">public:
    void commandHandler(byte cmdID, byte* inputs, unsigned int payload_size)
    {
        switch (cmdID){
            case 0x01:{  
            byte val [13] = "Hello World";  
            sendResponseMsg(cmdID, val, 13);
            break;
        }
        default:{
            // Do nothing
        }
    }
}
};</pre></div><p>The command IDs must match up with the operations that you add
to the MATLAB add-on library. For more information, see <a href="custom-library-concepts.html#bu73xge">Command Handler</a>.</p></li><li><p>(Optional) Use <code>debugPrint</code> to pass
additional messages from the Arduino device to the MATLAB command
line.</p></li></ol></div><div class="clearfix"></div><div itemprop="content"><span id="butixcv-1" class="anchor_target"></span><h3 class="title" id="butixcv-1">Create MATLAB Wrapper</h3><p>The MATLAB add-on
wrapper class that defines your library must inherit from <a href="../../../supportpkg/arduinoio/ref/arduinoio.librarybase-class.html"><code>arduinoio.LibraryBase</code></a>.
The <a href="../../../supportpkg/arduinoio/ref/arduinoio.librarybase-class.html"><code>arduinoio.LibraryBase</code></a> class
defines several constant properties that you must override in your MATLAB class. The class also contains
internal utility functions that enable you to send and retrieve data
from the server running on the Arduino board.</p><span id="mfile" class="anchor_target"></span><ol type="1"><li><p>Create a MATLAB class,
and define the command ID for each command that is sent to the server
on the board. </p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre><span style="color:#0000FF">classdef</span> HelloWorld &lt; arduinoio.LibraryBase
    <span style="color:#0000FF">properties</span>(Access = private, Constant = true)
        READ_COMMAND = hex2dec(<span style="color:#A020F0">'01'</span>)
    <span style="color:#0000FF">end</span>    
    <span style="color:#0000FF">...</span><span style="color:#228B22">        </span>
<span style="color:#0000FF">end</span>
</pre></div></div></div></li><li><p>Override constant properties in the class to specify
the location of source header files.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre><span style="color:#0000FF">classdef</span> HelloWorld &lt; arduinoio.LibraryBase
    <span style="color:#0000FF">...</span>
    <span style="color:#0000FF">properties</span>(Access = protected, Constant = true)
        LibraryName = <span style="color:#A020F0">'ExampleAddon/HelloWorld'</span>
        DependentLibraries = {}
        ArduinoLibraryHeaderFiles = {}
        CppHeaderFile = fullfile(arduinoio.FilePath(mfilename(<span style="color:#A020F0">'fullpath'</span>)), <span style="color:#A020F0">'src'</span>, <span style="color:#A020F0">'HelloWorld.h'</span>)
        CppClassName = <span style="color:#A020F0">'HelloWorld'</span>
    <span style="color:#0000FF">end</span>
    <span style="color:#0000FF">...</span>
<span style="color:#0000FF">end</span></pre></div></div></div><p>Define the class constructor, set the methods to call the class
constructor, and set the parent and pins properties.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre><span style="color:#0000FF">classdef</span> HelloWorld &lt; arduinoio.LibraryBase
    <span style="color:#0000FF">...</span>
    <span style="color:#0000FF">methods</span>
        <span style="color:#0000FF">function</span> obj = HelloWorld(parentObj)
            obj.Parent = parentObj;
            obj.Pins = [];
        <span style="color:#0000FF">end</span> 
        <span style="color:#0000FF">...</span>
    <span style="color:#0000FF">end</span>  
<span style="color:#0000FF">end</span>             </pre></div></div></div><p>If the device or code does not occupy any <code>arduino</code> pins
when in use, leave <code>obj.Pins</code> empty. Always assign
the first input argument to <code>obj.Parent</code>.</p><p> The support package auto-detects the class only if you have
redefined all the properties. If you do not need a value, leave the
field empty.</p></li><li><p>Define the method to read the data back.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre><span style="color:#0000FF">classdef</span> HelloWorld &lt; arduinoio.LibraryBase
    <span style="color:#0000FF">...</span>
    <span style="color:#0000FF">methods</span>
        <span style="color:#0000FF">...</span>
        <span style="color:#0000FF">function</span> out = read(obj)
            cmdID = obj.READ_COMMAND;
            inputs = [];
            output = sendCommand(obj, obj.LibraryName, cmdID, inputs);
            out = char(output);
        <span style="color:#0000FF">end</span>
    <span style="color:#0000FF">end</span>

<span style="color:#0000FF">end</span></pre></div></div></div></li></ol><p>For help on using MATLAB programming
language, see <a href="../../../matlab/object-oriented-design-with-matlab.html">Object-Oriented Design with MATLAB</a> (MATLAB).</p></div><div class="clearfix"></div><div itemprop="content"><span id="bu3l8rg-1" class="anchor_target"></span><h3 class="title" id="bu3l8rg-1">Register Add-On</h3><p>To register your add-on library, add the working folder that
contains <code>+arduinoioaddons</code> to the MATLAB path:</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>addpath <span style="color:#A020F0">C:\Work</span></pre></div></div></div><p>
<img src="filestructure.png" height="172" width="281" alt=""></p><p>Once you add the folder to the path, you should see the files
listed in the MATLAB Current
Folder browser.</p><p>Make sure the <code>ExampleAddon/HelloWorld</code> library
is available.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>listArduinoLibraries</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>listArduinoLibraries

ans = 

    'Adafruit/MotorShieldV2'
    'I2C'
    'SPI'
    'Servo'
    'ExampleAddon/HelloWorld'</pre></div></div></div><ul><span id="zmw57dd0e3443" class="anchor_target"></span><table class="note table table-condensed table-bordered" summary="Note"><tr width="90%"><td><p><b>Tip:</b>&nbsp;&nbsp;


If you do not see your add-on library in the list, see <a href="../../../supportpkg/arduinoio/ug/custom-arduino-library-issues.html">Custom Arduino Library Issues</a> for more information.</p></td></tr></table></ul></div><div class="clearfix"></div><div itemprop="content"><span id="bu0d8wp-1" class="anchor_target"></span><h3 class="title" id="bu0d8wp-1">Run MATLAB Code</h3>
<p>This example shows how to return data from
the Arduino library <code>commandHandler</code> to the MATLAB command
line.</p>
<p>Create an <code>arduino</code> object and include
the new library. Set <code>ForceBuild</code> to <code>true</code> to
reprogram the board.</p><div class="code_responsive"><pre class="programlisting">arduinoObj = arduino('COM3', 'Uno', 'Libraries', 'ExampleAddon/HelloWorld', 'ForceBuild', true);</pre></div><p>Arduino devices reuse cached code if the specified library
matches a library name in the source code. Reprogramming forces the
device to newly download the header file, ensuring current and accurate
information.</p><p>Create an add-on object using the <code>ExampleAddon</code> library.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>dev = addon(arduinoObj,<span style="color:#A020F0">'ExampleAddon/HelloWorld'</span>)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>dev = 

  ExampleAddon with properties:

    Pins: []</pre></div></div></div><p>Execute the command on the server, and read the data back
into MATLAB.</p><div class="code_responsive"><div class="programlisting"><div class="codeinput"><pre>read (dev)</pre></div></div></div><div class="code_responsive"><div class="programlisting"><div class="codeoutput"><pre>ans =

Hello World! </pre></div></div></div></div>
</div></section>

<div class="clearfix"></div>
<div class="feedbackblock">Was this topic helpful?
<input type="button" value="Yes" onClick="openFeedbackWindow('http://www.mathworks.com/programs/bounce_hub_help.html?s_cid=Help_Topic_Survey&amp;surveyParams='+document.location.href+'-YES-R2017a');">
<input type="button" value="No" onClick="openFeedbackWindow('http://www.mathworks.com/programs/bounce_hub_help.html?s_cid=Help_Topic_Survey&amp;surveyParams='+document.location.href+'-NO-R2017a');">
</div>
<!--Last updated: Thu Jun 22 14:13:07 EDT 2017-->
</div>
</div>
</div><!--close_0960-->
</div><!--close_0970-->
<div class="body_trail_container">
<div class="container-fluid">
<div class="row">
<div class="col-xs-12">
<div class="row"><div class="col-xs-12 col-sm-3"><h5><a href="../index.html?s_cid=doc_ftr">MATLAB Support Package for Arduino Hardware Documentation</a></h5>
<ul class="list-unstyled hidden-xs"><li><a href="../examples.html?s_cid=doc_ftr">Examples</a></li>
<li><a href="../troubleshooting-in-matlab-support-package-for-arduino-hardware.html?s_cid=doc_ftr">Troubleshooting</a></li>
<li><a href="../functionlist.html?s_cid=doc_ftr">Functions and Other Reference</a></li>
<li><a href="../release-notes.html?s_cid=doc_ftr">Release Notes</a></li>
</ul>
</div>
<div class="col-xs-12 col-sm-3"><h5><a href="../../../documentation-center.html?s_cid=doc_ftr">Other Documentation</a></h5>
<ul class="list-unstyled hidden-xs"><li><a href="../../../matlab/index.html?s_cid=doc_ftr">MATLAB</a></li><li><a href="../../../supportpkg/arduino/index.html?s_cid=doc_ftr">Simulink Support Package for Arduino Hardware</a></li><li><a href="../../../supportpkg/raspberrypiio/index.html?s_cid=doc_ftr">MATLAB Support Package for Raspberry Pi Hardware</a></li><li><a href="../../../supportpkg/legomindstormsev3io/index.html?s_cid=doc_ftr">MATLAB Support Package for LEGO MINDSTORMS EV3 Hardware</a></li><li><a href="../../../documentation-center.html?s_cid=doc_ftr">Documentation Home</a></li></ul>
</div>
<div class="col-xs-12 col-sm-3"><h5><a href="http://www.mathworks.com/support/?s_cid=doc_ftr">Support</a></h5>
<ul class="list-unstyled hidden-xs"><li><a href="http://www.mathworks.com/matlabcentral/answers/index?s_cid=doc_ftr">MATLAB Answers</a></li><li><a href="http://www.mathworks.com/support/install-matlab.html?s_cid=doc_ftr">Installation Help</a></li><li><a href="http://www.mathworks.com/support/bugreports/?s_cid=doc_ftr">Bug Reports</a></li><li><a href="http://www.mathworks.com/products/availability/?s_cid=doc_ftr">Product Requirements</a></li><li><a href="http://www.mathworks.com/downloads/?s_cid=doc_ftr">Software Downloads</a></li></ul>
</div>
</div>
</div>
</div>
</div><!--END.CLASS container-fluid-->
</div><!--END.CLASS body_trail_container-->
<footer id="footer" class="bs-footer">
<div class="container-fluid">
<div class="footer">
<div class="row">
<div class="col-xs-12">
<p class="copyright">&copy; 1994-2017 The MathWorks, Inc.</p>
<ul class="footernav"><li class="footernav_help"><a href="MATLAB:web(matlab.internal.licenseAgreement)">Terms of Use</a></li><li class="footernav_patents"><a href="MATLAB:web([matlabroot '/patents.txt'])">Patents</a></li><li class="footernav_trademarks"><a href="MATLAB:web([matlabroot '/trademarks.txt'])">Trademarks</a></li><li class="footernav_piracy"><a href="MATLAB:web([docroot '/acknowledgments.html'])">Acknowledgments</a></li></ul></div>
</div>
</div>
</div>
</footer>
</div><!--close row-offcanvas-->
</body>
</html>
